"use strict";class Buffer{constructor(a,b,c){this.type=a,this.id=gl.createBuffer(),this.bind(),gl.bufferData(this.type,c,b)}bind(){gl.bindBuffer(this.type,this.id)}unbind(){gl.bindBuffer(this.type,null)}delete(){this.unbind(),gl.deleteBuffer(this.id)}}class VertexBuffer extends Buffer{constructor(a){super(gl.ARRAY_BUFFER,gl.STATIC_DRAW,new Float32Array(a))}}class IndexBuffer extends Buffer{constructor(a){super(gl.ELEMENT_ARRAY_BUFFER,gl.STATIC_DRAW,new Uint32Array(a))}}class VertexArray{constructor(a){this.id=gl.createVertexArray(),gl.bindVertexArray(this.id);this.layout=new class{constructor(){this.elements=[],this.stride=0}add(b,c,d,e=!1){const f=a.shader.getAttribLocation(b);return-1!==f&&this.elements.push({index:f,type:c,count:d,normalized:e}),this.stride+=d*bytes(c),f}clear(){this.elements=[],this.stride=0}}}addBuffer(a){this.bind(),a.bind();let b=0;this.layout.elements.forEach(a=>{gl.enableVertexAttribArray(a.index),gl.vertexAttribPointer(a.index,a.count,a.type,a.normalized,this.layout.stride,b),b+=a.count*bytes(a.type)})}bind(){gl.bindVertexArray(this.id)}unbind(){gl.bindVertexArray(null)}delete(){this.unbind(),vertexArray.layout.elements.forEach(a=>gl.disableVertexAttribArray(a.index)),gl.deleteVertexArray(this.id)}}window.addEventListener("load",HummingbirdSetup);let HummingbirdCanvas,gl;const Hummingbird={version:"v0.0.30",noUpdate:!1,toLoad:0,loadTimeout:5e3,frames:0,prevTime:0,mouse:[0,0],mouseIsPressed:!1,renderer:void 0,textures:[]};function HummingbirdSetup(){function a(){"function"==typeof setup&&setup(),"function"==typeof update&&!0!==Hummingbird.noUpdate&&requestAnimationFrame(HummingbirdUpdate)}if(console.log("Hummingbird "+Hummingbird.version+" by SantaClausNL. https://www.santaclausnl.ga/"),"function"==typeof preload){preload();const b=document.createTextNode("LOADING...");if(document.body.appendChild(b),0>=Hummingbird.toLoad)a();else{let c=0;const d=setInterval(()=>{0>=Hummingbird.toLoad||c>=Hummingbird.loadTimeout?(c>=Hummingbird.loadTimeout&&console.warn("Failed to load assets."),clearInterval(d),b.remove(),a()):c+=25},25)}}else a()}function init(a,b,c){if(defined(c)||(c={}),!0===c.noUpdate&&(Hummingbird.noUpdate=!0),defined(c.canvas)?(HummingbirdCanvas=c.canvas,gl=HummingbirdCanvas.getContext("webgl2")):(HummingbirdCanvas=document.createElement("CANVAS"),gl=HummingbirdCanvas.getContext("webgl2"),defined(c.parent)?c.parent.appendChild(HummingbirdCanvas):document.body.appendChild(HummingbirdCanvas)),null===gl){HummingbirdCanvas.parentNode.removeChild(HummingbirdCanvas);const a=document.createElement("p");a.innerText="WebGL2 is not supported on your browser or machine.",defined(c.parent)?c.parent.appendChild(a):document.body.appendChild(a)}else HummingbirdCanvas.width=a||100,HummingbirdCanvas.height=b||100,HummingbirdCanvas.id=defined(c.id)?c.id:"HummingbirdCanvas",Hummingbird.renderer=new Renderer;"function"==typeof keyPressed&&window.addEventListener("keydown",a=>{keyPressed(a)}),"function"==typeof keyReleased&&window.addEventListener("keyup",a=>{keyReleased(a)}),window.addEventListener("mousemove",a=>{Hummingbird.mouse=getMousePos(a),"function"==typeof mouseMoved&&mouseMoved(a)}),window.addEventListener("mousedown",a=>{Hummingbird.mouseIsPressed=!0,"function"==typeof mousePressed&&mousePressed(a)}),window.addEventListener("mouseup",a=>{Hummingbird.mouseIsPressed=!1,"function"==typeof mouseReleased&&mouseReleased(a)}),window.addEventListener("beforeunload",()=>{Hummingbird.textures.forEach(a=>{a.delete()}),Hummingbird.renderer.delete()})}function resizeWindow(a,b){HummingbirdCanvas.width=a,HummingbirdCanvas.height=b,gl.viewport(0,0,a,b),projectionMatrix=Mat4.orthographic(0,HummingbirdCanvas.width,0,HummingbirdCanvas.heigh,-100,100)}function HummingbirdUpdate(a){const b=a-Hummingbird.prevTime;Hummingbird.prevTime=a,update(b),Hummingbird.frames++,requestAnimationFrame(HummingbirdUpdate)}class Meth{static radians(a){return a*(Math.PI/180)}static degrees(a){return a*(180/Math.PI)}}class Mat4{static new(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){return[a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p]}static identity(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}static orthographic(a,b,c,d,e=-1,f=1){return[2/(b-a),0,0,-((b+a)/(b-a)),0,2/(c-d),0,-((c+d)/(c-d)),0,0,-2/(f-e),-((f+e)/(f-e)),0,0,0,1]}static perspective(a,b,c,d){let e=1/Math.tan(a/2),f=1/(c-d);return[e/b,0,0,0,0,e,0,0,0,0,(d+c)*f,-1,0,0,2*d*c*f,0]}static multMat4(a,b){const c=Vec4.multMat4([b[0],b[1],b[2],b[3]],a),d=Vec4.multMat4([b[4],b[5],b[6],b[7]],a),e=Vec4.multMat4([b[8],b[9],b[10],b[11]],a),f=Vec4.multMat4([b[12],b[13],b[14],b[15]],a);return[c[0],c[1],c[2],c[3],d[0],d[1],d[2],d[3],e[0],e[1],e[2],e[3],f[0],f[1],f[2],f[3]]}static scale(a,b){return Mat4.multMat4(a,[b[0],0,0,0,0,b[1],0,0,0,0,b[2],0,0,0,0,1])}static translate(a,b){return Mat4.multMat4(a,[1,0,0,b[0],0,1,0,b[1],0,0,1,b[2],0,0,0,1])}static rotateX(a,b){var c=Math.sin,d=Math.cos;return Mat4.multMat4(a,[1,0,0,0,0,d(-b),c(b),0,0,c(-b),d(-b),0,0,0,0,1])}static rotateY(a,b){var c=Math.sin,d=Math.cos;return Mat4.multMat4(a,[d(-b),0,c(-b),0,0,1,0,0,c(b),0,d(-b),0,0,0,0,1])}static rotateZ(a,b){var c=Math.sin,d=Math.cos;return Mat4.multMat4(a,[d(-b),c(b),0,0,c(-b),d(-b),0,0,0,0,1,0,0,0,0,1])}}class Vec2{static new(a,b){return[a,b]}}class Vec3{static new(a,b,c){return[a,b,c]}}class Vec4{static new(a,b,c,d){return[a,b,c,d]}static multVec4(a,b){return[a[0]*b[0],a[1]*b[1],a[2]*b[2],a[3]*b[3]]}static multMat4(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12],a[0]*b[1]+a[1]*b[5]+a[2]*b[9]+a[3]*b[13],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]+a[3]*b[14],a[0]*b[3]+a[1]*b[7]+a[2]*b[11]+a[3]*b[15]]}}class Renderer{constructor(){gl.enable(gl.BLEND),gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA),gl.clearColor(0,0,0,1),this.shader=new Shader,this.shader.bind(),this.vertexArray=new VertexArray(this);this.vertexBuffer=new VertexBuffer([100,100,0,0,0,1,1,0,0,1,200,100,0,0,0,1,1,1,0,1,200,200,0,0,0,1,1,1,1,1,100,200,0,0,0,1,1,0,1,1]),this.vertexArray.layout.add("aVertexPosition",gl.FLOAT,3),this.vertexArray.layout.add("aVertexColor",gl.FLOAT,4),this.vertexArray.layout.add("aTexturePosition",gl.FLOAT,2),this.vertexArray.layout.add("aTextureId",gl.FLOAT,1),this.vertexArray.addBuffer(this.vertexBuffer);this.indexBuffer=new IndexBuffer([0,1,2,2,3,0]);{const a=gl.createTexture();gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,a),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.REPEAT),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA8,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,new Uint8Array([255,255,255,255]))}this.projectionMatrix=Mat4.orthographic(0,HummingbirdCanvas.width,0,HummingbirdCanvas.height,-100,100),this.viewMatrix=Mat4.identity(),this.modelMatrix=Mat4.identity()}clear(){gl.clear(gl.COLOR_BUFFER_BIT)}draw(a,b,c){a.bind(),b.bind(),a.setUniform("i","uTextureId",[1]),gl.drawElements(gl.TRIANGLES,c,gl.UNSIGNED_INT,0)}delete(){this.shader.delete(),this.vertexArray.delete(),this.vertexBuffer.delete(),this.indexBuffer.delete()}}class Shader{constructor(a,b){this.vertexShaderSource=a||`
			attribute vec4 aVertexPosition;
			attribute vec4 aVertexColor;
			attribute vec2 aTexturePosition;
			attribute float aTextureId;

			varying vec4 vVertexColor;
			varying vec2 vTexturePosition;

			uniform mat4 uMVP;

			void main() {
				gl_Position = uMVP * aVertexPosition;
				vVertexColor = aVertexColor;
				vTexturePosition = aTexturePosition;
			}
		`,this.fragmentShaderSource=b||`
			precision mediump float;
			varying vec4 vVertexColor;
			varying vec2 vTexturePosition;

			uniform sampler2D uTextureId;

			void main() {
				gl_FragColor = texture2D(uTextureId, vTexturePosition);// * vVertexColor;
			}
		`,this.id=this.createProgram(this.vertexShaderSource,this.fragmentShaderSource),this.attribLocationCache={},this.uniformLocationCache={}}createProgram(a,b){const c=gl.createProgram(),d=this.compileShader(gl.VERTEX_SHADER,a),e=this.compileShader(gl.FRAGMENT_SHADER,b);return gl.attachShader(c,d),gl.attachShader(c,e),gl.linkProgram(c),gl.validateProgram(c),gl.deleteShader(d),gl.deleteShader(e),c}compileShader(a,b){const c=gl.createShader(a);return gl.shaderSource(c,b),gl.compileShader(c),!1===gl.getShaderParameter(c,gl.COMPILE_STATUS)?(console.error(gl.getShaderInfoLog(c)),gl.deleteShader(c),null):c}getAttribLocation(a){return void 0===this.attribLocationCache[a]&&(this.attribLocationCache[a]=gl.getAttribLocation(this.id,a)),this.attribLocationCache[a]}getUniformLocation(a){return void 0===this.uniformLocationCache[a]&&(this.uniformLocationCache[a]=gl.getUniformLocation(this.id,a)),this.uniformLocationCache[a]}setUniform(a,b,c){gl["uniform"+c.length+a](this.getUniformLocation(b),c[0],c[1],c[2],c[3])}setUniformMatrix(a,b,c){gl["uniformMatrix"+Math.sqrt(c.length)+a+"v"](this.getUniformLocation(b),!0,c)}bind(){gl.useProgram(this.id)}unbind(){gl.useProgram(null)}delete(){this.unbind(),gl.deleteProgram(this.id)}}class Texture{constructor(a){this.id=0,this.createTexture(a)}setErrorTexture(){this.bind();const a=new Uint8Array([255,255,255,255,191,191,191,255,191,191,191,255,255,255,255,255]);this.setTextureParameters(gl.NEAREST,gl.REPEAT),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA8,2,2,0,gl.RGBA,gl.UNSIGNED_BYTE,a)}createTexture(a){if(this.id=gl.createTexture(),this.setErrorTexture(),!defined(a))return;const b=new Image;b.onload=()=>{this.bind(),this.setTextureParameters(gl.LINEAR,gl.CLAMP_TO_EDGE),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA8,gl.RGBA,gl.UNSIGNED_BYTE,b)},b.src=a}setTextureParameters(a,b){gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,a),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,a),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,b),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,b)}bind(a=1){gl.activeTexture(gl["TEXTURE"+a]),gl.bindTexture(gl.TEXTURE_2D,this.id)}unbind(){gl.bindTexture(gl.TEXTURE_2D,null)}delete(){this.unbind(),gl.deleteTexture(this.id)}}function bytes(a){return a===gl.FLOAT||a===gl.UNSIGNED_INT?4:a===gl.BYTE?1:void 0}function defined(a){return a!==void 0}function getMousePos(a){const b=HummingbirdCanvas.getBoundingClientRect(),c=document.body;return[a.clientX-b.left-c.scrollLeft,a.clientY-b.top-c.scrollTop]}